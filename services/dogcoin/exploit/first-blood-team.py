from itertools import product, count
from functools import reduce
import random
import fixedint

alphabet = [ord(c) for c in "abcdefghijklmnopqrstuvwxyz"]

for x in product(alphabet, repeat=3):
    msg = bytes([ord('a'), x[0], x[1], ord('p'), x[2]] * 3)

    xsum = sum(msg)
    xsumhalf = sum(msg[:5])
    xxor = reduce(lambda x, y: x ^ y, msg, 0)
    xmul = reduce(lambda x, y: x * y, msg, fixedint.Int64(1))
    xand = reduce(lambda x, y: x & y, msg, 0xff)
    if ((xsum % 5) in (1, 2, 3) and
        (xsumhalf % 7) in (0, 1, 5, 6) and
        (xxor % 5) in (2, 3) and
        (xand == 0x60) and
        (xmul % 7) in (0, 1, 3) and
        (xsum % 7) in (2, 3, 4, 5, 6) and
        (len(msg) + xsum % 5 + xsumhalf % 5 + xxor % 5 + xmul % 5) == 21):
        print(msg)

